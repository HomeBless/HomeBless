{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block head %}
  <script src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&libraries=maps,marker,places,geometry&callback=initMap" defer></script>
{% endblock %}

{% block content %}

    <div class="pt-[178px] pb-[60px]">
        <!-- search bar -->
        {% include "components/search_bar.html" %}
        <!-- info -->
        <div class="flex flex-col items-start gap-6 w-full h-auto p-8 flex-shrink-0 pb-10">
            <!-- properties detail -->
            <div class="flex flex-col items-center gap-[88px] self-stretch">
                <div class="flex flex-col items-start gap-[24px] self-stretch">
                    <!-- images -->
                    <div class="flex items-center gap-[16px] self-stretch">
                        <div class="h-[503px] flex-[1_0_0] justify-center items-center bg-cover bg-center"
                             style="background-image: url('{{ property.main_image }}');"></div>
                        <div class="flex flex-col w-[498px] h-[503px] items-start gap-[16px]">
                            <div class="flex items-center gap-[16px] flex-[1_0_0] self-stretch">
                                {% for image in property.extra_images.all|slice:":2" %}
                                    <div class="flex-[1_0_0] self-stretch bg-cover bg-center bg-no-repeat"
                                         style="background-image: url('{{ image.image.url }}');"></div>
                                {% endfor %}
                            </div>
                            <div class="flex items-end gap-[16px] flex-[1_0_0] self-stretch">
                                {% for image in property.images.all|slice:"2:4" %}
                                    <div class="flex-[1_0_0] self-stretch bg-cover bg-center bg-no-repeat"
                                         style="background-image: url('{{ image.image.url }}');"></div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                <!-- description -->
                <div class="flex flex-col items-start gap-[16px] self-stretch">
                    <!-- status -->
                    <div class="flex items-center gap-[16px]">
                        <div class="flex p-1.5 justify-center items-center gap-1.5 rounded-[10px] bg-green-300/30">
                            <p class="text-[#2DAB6F] text-base font-normal leading-normal">
                                {% if selling_type == "For Sell" %}
                                    ขาย
                                {% elif selling_type == "For Rent" %}
                                    เช่า
                                {% endif %}
                            </p>
                        </div>
                    </div>
                    <!-- Title -->
                    <div class="self-stretch inline-flex justify-start items-start gap-4">
                        <div class="flex-1 justify-start text-slate-600 text-3xl font-bold font-['IBM_Plex_Sans_Thai']">
                            {{ property.title }}
                        </div>
                        {% if user_is_authenticated %}
                        <form method="POST" action="{% url 'HomeBless:property-detail' pk=property.pk %}">
                            {% csrf_token %}
                            <input type="hidden" name="bookmark_property" value="{{ property.id }}">
                            <button onclick="toggleBookmark(this)" class="relative p-2 rounded-full transition-transform duration-200 hover:scale-110 focus:outline-none">
                                <span class="absolute inset-0 rounded-full bg-blue-500 opacity-0 scale-50 transition-all duration-300 ease-out group-hover:opacity-20"></span>
                                <img id="bookmark-icon"
                                     src="{% if wishlist_bool %}{% static 'property-detail/booked.svg' %}{% else %}{% static 'property-detail/bookmark.svg' %}{% endif %}"
                                     alt="Bookmark"
                                     class="w-15 h-15 relative z-10">
                            </button>
                        </form>
                        {% endif %}
                    </div>
                    <!-- Location pin -->
                    <div class="flex p-2 px-3 justify-center items-center gap-1.5 rounded-md bg-[#2162D0]">
                        <div class="flex items-center gap-2">
                            <div class="h-[14px] w-[13px]">
                                <img id="bookmark-icon" src="{% static 'property-detail/location_pin.svg' %}" alt="Bookmark">
                            </div>
                            <div class="text-[#FAF9F6] font-bold text-[16px]">
                                {{ property.location }}
                            </div>
                        </div>
                    </div>
                    <!-- Price -->
                    <div class="flex flex-col items-start gap-[-10px] self-stretch">
                        <div class="text-[#575B6F] font-bold text-[16px] self-stretch">
                            ราคา
                        </div>
                        <div class="text-[#2DAB6F] font-bold text-[48px] self-stretch uppercase">{{ property.price|intcomma }}
                            บาท
                        </div>
                    </div>
                </div>

                <!-- Property Info Card-->
                {% include "components/card.html" %}

                <!-- Additional Info -->
                <div class="flex justify-between items-start self-stretch">
                    <!-- Tags Tabs -->
                    <div class="flex flex-col items-start gap-[24px] flex-[1_0_0]">
                        <!-- Navigation -->
                        <div class="flex items-center gap-[16px] self-stretch">
                            <button class="tab-info-btn flex p-2.5 px-5 justify-center items-center gap-1.5 border-b-2 border-[#2162D0]"
                                    data-tab="details">
                                <div class="text-[#2162D0] font-normal text-[16px]">
                                    รายละเอียดเพิ่มเติม
                                </div>
                            </button>
                            <button class="tab-info-btn flex p-2.5 px-5 justify-center items-center gap-1.5"
                                    data-tab="messages">
                                <div class="text-[#2162D0] font-normal text-[16px]">
                                    ข้อความจากเจ้าของ/นายหน้า
                                </div>
                            </button>
                            <button class="tab-info-btn flex p-2.5 px-5 justify-center items-center gap-1.5"
                                    data-tab="location">
                                <div class="text-[#2162D0] font-normal text-[16px]">
                                    ทำเลที่ตั้งและการเดินทาง
                                </div>
                            </button>
                        </div>
                        <!-- Tabs Content for 'Details' -->
                        <div class="tab-content flex flex-col items-start gap-[16px] self-stretch"
                             data-tab-content="details">

                            <!-- Tag -->
                            {% include "components/tag.html" %}

                            <!-- Message -->
                            {% include "components/message.html" %}

                        <!-- Tabs Content for 'Location' -->
                        <div class="tab-content hidden flex flex-col items-start gap-[16px] self-stretch"
                             data-tab-content="location">
                            <!-- Content -->
                            <div class="flex items-center gap-[10px] self-stretch px-[20px] pb-[20px]">
                                <!-- Map + Address -->
                                <div class="flex items-start gap-[24px] self-stretch">
                                    <!-- Address -->
                                    <div class="flex flex-col items-start gap-[17px] flex-[1_0_0]">
                                        <div class="flex flex-col items-start gap-[64px] self-stretch max-w-[500px]">
                                            <div class="text-[#2162D0] font-medium text-[22px]">
                                                ทำเลที่ตั้ง
                                            </div>
                                            <div class="flex flex-col items-start gap-[16px] self-stretch">
                                                <div class="flex flex-col items-start gap-[8px] self-stretch">
                                                    <div class="text-[#575B6F] font-bold text-[16px] self-stretch">
                                                        ที่อยู่
                                                    </div>
                                                    <div class="text-[#575B6F] font-normal text-[16px] self-stretch">
                                                      {{ address }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                      <a href="https://www.google.com/maps?q={{ property.latitude }}, {{ property.longitude }}" target="_blank" class="flex w-full items-center justify-center gap-2 px-4 py-2">
                                        <button class="flex w-full items-center justify-center gap-2 px-4 py-2 border border-gray-300 bg-offWhite rounded-md hover:bg-gray-100">
                                            <div class="w-[21px] h-[21px]">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="21" height="22"
                                                     viewBox="0 0 21 22" fill="none">
                                                    <g clip-path="url(#clip0_37_771)">
                                                        <path d="M18.5312 10.325V19.2522L15.7257 18.7329L14.4888 17.2492L9.27734 11.4556L13.7019 8.31177C15.9183 11.2372 15.9882 10.5241 15.9882 10.5241C15.9882 10.5241 17.083 8.8896 18.4875 10.2941L18.5312 10.325Z"
                                                              fill="#CCCCCC"/>
                                                        <path d="M7.82186 9.65076L17.0221 21.4918C16.9681 21.4972 16.9139 21.4999 16.8597 21.5H1.81836L7.82186 9.65076Z"
                                                              fill="#518EF8"/>
                                                        <path d="M13.702 8.31175L0.0183105 19.8285V4.65853C0.0183105 3.73519 0.76701 2.98706 1.68978 2.98706H11.6684C11.2399 3.72354 12.8287 4.19624 12.8287 5.1097C12.8287 6.02903 13.2683 7.57179 13.702 8.31175Z"
                                                              fill="#28B446"/>
                                                        <path d="M18.5313 19.2522V19.8285C18.5313 20.6966 17.8694 21.4103 17.0223 21.4918L9.32349 13.8943L11.1871 12.0057L15.4883 16.2499L15.7258 16.4845L18.5313 19.2522Z"
                                                              fill="#F2F2F2"/>
                                                        <path d="M13.2281 9.93722L11.1869 12.0057L9.32336 13.8943L1.81845 21.5H1.68978C0.76701 21.5 0.0183105 20.7513 0.0183105 19.8286L11.6772 8.01367C11.8955 8.38745 13.397 8.009 13.702 8.31173L14.2627 9.03246C14.5363 9.3242 12.9929 9.62751 13.2281 9.93722Z"
                                                              fill="#FFD837"/>
                                                        <path d="M4.3847 9.84229C2.91602 9.84229 1.72119 8.64746 1.72119 7.17877C1.72119 5.71008 2.91602 4.51526 4.3847 4.51526C5.09567 4.51526 5.76435 4.79244 6.26773 5.29579L5.65016 5.91324C5.31186 5.57486 4.86241 5.38852 4.3847 5.38852C3.39754 5.38852 2.5945 6.19161 2.5945 7.17873C2.5945 8.16585 3.39758 8.96894 4.3847 8.96894C5.22126 8.96894 5.9257 8.39218 6.12106 7.61534H4.3847V6.74208H7.04822V7.17873C7.04818 8.64746 5.85339 9.84229 4.3847 9.84229Z"
                                                              fill="#575B6F"/>
                                                        <path d="M11.6685 2.98711C12.533 1.50021 14.1439 0.5 15.9883 0.5C18.7461 0.5 20.9817 2.7356 20.9817 5.49341C20.9817 6.18505 20.8408 6.84348 20.587 7.44255C20.3342 8.03706 19.9686 8.57698 19.5105 9.03248C19.1321 9.43476 18.7927 9.85977 18.4876 10.2941C16.489 13.1415 15.9883 16.3925 15.9883 16.3925C15.9883 16.3925 15.4445 12.8627 13.2281 9.9372C12.9929 9.62749 12.7391 9.32414 12.4655 9.03248H12.4661C12.1599 8.72863 11.8947 8.38613 11.6772 8.01365C11.2435 7.27369 10.9949 6.41265 10.9949 5.49337C10.9949 4.57995 11.24 3.72354 11.6685 2.98711Z"
                                                              fill="#F14336"/>
                                                        <path d="M15.9883 2.83569C17.4559 2.83569 18.6453 4.02584 18.6453 5.49342C18.6453 6.961 17.4559 8.15046 15.9883 8.15046C14.5207 8.15046 13.3306 6.961 13.3306 5.49342C13.3306 4.02584 14.5208 2.83569 15.9883 2.83569Z"
                                                              fill="#7E2D25"/>
                                                    </g>
                                                    <defs>
                                                        <clipPath id="clip0_37_771">
                                                            <rect width="21" height="21" fill="white"
                                                                  transform="translate(0 0.5)"/>
                                                        </clipPath>
                                                    </defs>
                                                </svg>
                                            </div>
                                            <div class="text-[#444F85] font-normal text-[16px]">
                                                ดูใน Google map
                                            </div>
                                        </button>
                                      </a>
                                    </div>
                                    <!-- Map -->
                                    <div class="flex w-[377px] flex-col justify-between items-start self-stretch">
                                        <div class="flex flex-col items-center flex-1 self-stretch rounded-lg border border-gray-300">
                                          <gmp-map center="{{ property.latitude }},{{ property.longitude }}" zoom="14" style="height: 100%;" map-id="DEMO_MAP_ID">
                                            <!-- Add the gmp-advanced-marker component -->
                                            <gmp-advanced-marker position="{{ property.latitude }},{{ property.longitude }}" title=""></gmp-advanced-marker>
                                          </gmp-map>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- NearBy Places -->
                            <div class="flex items-center gap-[10px] self-stretch px-[20px] pb-[20px]">
                                <div class="flex flex-col items-start gap-[8px] self-stretch">
                                    <div class="text-[#2162D0] font-medium text-[22px] self-stretch">
                                        สถานที่ใกล้เคียง
                                    </div>
                                    <!-- Navigations -->
                                    <div class="flex items-center gap-[16px] self-stretch">
                                        <button class="tab-nearby-btn flex items-center justify-center gap-1 px-5 py-2 border-b-2 border-[#575B6F] hover:bg-gray-100" data-category="all">
                                            <div class="text-[#575B6F] font-normal text-[16px]">ทั้งหมด</div>
                                        </button>
                                        <button class="tab-nearby-btn flex items-center justify-center gap-1 px-5 py-2 hover:bg-gray-100" data-category="school">
                                            <div class="text-[#575B6F] font-normal text-[16px]">โรงเรียน/มหาวิทยาลัย</div>
                                        </button>
                                        <button class="tab-nearby-btn flex items-center justify-center gap-1 px-5 py-2 hover:bg-gray-100" data-category="airport">
                                            <div class="text-[#575B6F] font-normal text-[16px]">สนามบิน</div>
                                        </button>
                                        <button class="tab-nearby-btn flex items-center justify-center gap-1 px-5 py-2 hover:bg-gray-100" data-category="mall">
                                            <div class="text-[#575B6F] font-normal text-[16px]">ห้างสรรพสินค้า</div>
                                        </button>
                                      <button class="tab-nearby-btn flex items-center justify-center gap-1 px-5 py-2 hover:bg-gray-100" data-category="hospital">
                                            <div class="text-[#575B6F] font-normal text-[16px]">โรงพยาบาล</div>
                                        </button>
                                      <button class="tab-nearby-btn flex items-center justify-center gap-1 px-5 py-2 hover:bg-gray-100" data-category="transport">
                                            <div class="text-[#575B6F] font-normal text-[16px]">สถานีรถไฟฟ้า</div>
                                        </button>
                                    </div>
                                    <!-- Table List -->
                                    <div class="flex items-center px-5 gap-2 self-stretch">
                                        <table class="w-full border-collapse">
                                            <thead>
                                                <tr>
                                                    <th class="text-left font-bold text-[16px] border-b border-[#575B6F] p-2">สถานที่</th>
                                                    <th class="text-left font-bold text-[16px] border-b border-[#575B6F] p-2 bg-indigo-100">ระยะทาง</th>
                                                </tr>
                                            </thead>
                                            <tbody id="nearby-places">
                                            {% for place in nearby_university %}
                                                <tr data-category="school">
                                                    <td class="p-2">{{ place.name }}</td>
                                                    <td class="p-2 bg-indigo-100">{{ place.distance }}</td>
                                                </tr>
                                            {% endfor %}
                                            {% for place in nearby_school %}
                                                <tr data-category="school">
                                                    <td class="p-2">{{ place.name }}</td>
                                                    <td class="p-2 bg-indigo-100">{{ place.distance }}</td>
                                                </tr>
                                            {% endfor %}
                                            {% for place in nearby_airport %}
                                                <tr data-category="airport">
                                                    <td class="p-2">{{ place.name }}</td>
                                                    <td class="p-2 bg-indigo-100">{{ place.distance }}</td>
                                                </tr>
                                            {% endfor %}
                                            {% for place in nearby_mall %}
                                                <tr data-category="mall">
                                                    <td class="p-2">{{ place.name }}</td>
                                                    <td class="p-2 bg-indigo-100">{{ place.distance }}</td>
                                                </tr>
                                            {% endfor %}
                                            {% for place in nearby_hospital %}
                                                <tr data-category="hospital">
                                                    <td class="p-2">{{ place.name }}</td>
                                                    <td class="p-2 bg-indigo-100">{{ place.distance }}</td>
                                                </tr>
                                            {% endfor %}
                                            {% for place in nearby_transport %}
                                                <tr data-category="transport">
                                                    <td class="p-2">(สถานีรถไฟฟ้า) {{ place.name }}</td>
                                                    <td class="p-2 bg-indigo-100">{{ place.distance }}</td>
                                                </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Contact&Compare Frame -->
                    <div class="flex w-[358px] flex-col justify-center items-start gap-8">
                        <!-- Contact Frame -->
                        <div class="flex flex-col items-start gap-6 self-stretch">
                            <div class="flex justify-center items-center gap-2.5 self-stretch border-b border-[#575B6F]">
                                <div class="text-[#575B6F] font-medium text-[22px] flex-[1_0_0]">
                                    ช่องทางการติดต่อ
                                </div>
                            </div>
                            <!-- Profile -->
                            <div class="flex flex-col items-center gap-[16px] self-stretch">
                                <div class="flex items-center gap-[16px] self-stretch">
                                    <!-- profile pic -->
                                    <div class="w-[55px] h-[55px] rounded-[237px] bg-[url('{% static "profilePic.jpeg" %}')] bg-[lightgray_-1.876px_-12.399px] bg-[length:176.056%_227.066%] bg-no-repeat">
                                    </div>
                                    <!-- profile name -->
                                    <div class="flex w-[92px] flex-col items-start gap-0.75">
                                        <div class="text-[#2162D0] font-bold text-[16px] self-stretch">
                                            {{ seller_name }}
                                        </div>
                                        <div class="flex items-center gap-[16px]">
                                            <div class="flex p-0.5 px-1.5 justify-center items-center gap-1.5 rounded-lg bg-[rgba(86,223,150,0.30)]">
                                                <div class="text-[#2DAB6F] font-medium text-[12px] self-stretch">
                                                    {{ seller_status }}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Contact detail -->
                                <div class="flex flex-col items-start gap-[8px] self-stretch">
                                    <!-- Methods -->
                                    <div class="flex flex-col items-start gap-[10px] self-stretch">
                                        <!-- Tel Button -->
                                        {% if seller_phone %}
                                        <button name="tel" onclick="flipCard(this, 'tel-info')" class="flip-card flex p-2 items-center gap-2 self-stretch rounded-md border border-[#D0D9EF] bg-[#FAF9F6] transition-transform duration-300">
                                            <div class="flip-card-inner">
                                                <div class="flip-card-front flex items-center gap-2">
                                                    <div class="w-[18px] h-[18px]">
                                                        <img src="{% static 'property-detail/phone.svg' %}" alt="Phone">
                                                    </div>
                                                    <div class="text-[#444F85] font-medium text-[16px]">
                                                        โทรหาเจ้าของ/นายหน้า
                                                    </div>
                                                </div>
                                                <div class="flip-card-back flex items-center gap-2 hidden" id="tel-info">
                                                    <div class="w-[18px] h-[18px]">
                                                        <img src="{% static 'property-detail/phone.svg' %}" alt="Phone">
                                                    </div>
                                                    <div class="text-[#444F85] font-medium text-[16px]">
                                                        {{ seller_phone }}
                                                    </div>
                                                </div>
                                            </div>
                                        </button>
                                        {% endif %}

                                        <!-- Line Button -->
                                        {% if seller_line_id %}
                                        <button name="line" onclick="flipCard(this, 'line-info')" class="flip-card flex p-2 items-center gap-2 self-stretch rounded-md border border-[#D0D9EF] bg-[#FAF9F6] transition-transform duration-300">
                                            <div class="flip-card-inner">
                                                <div class="flip-card-front flex items-center gap-2">
                                                    <div class="w-[20px] h-[20px]">
                                                        <img src="{% static 'property-detail/line.svg' %}" alt="Line">
                                                    </div>
                                                    <div class="text-[#444F85] font-medium text-[16px]">
                                                        เพิ่มเพื่อนในไลน์
                                                    </div>
                                                </div>
                                                <div class="flip-card-back flex items-center gap-2 hidden" id="line-info">
                                                    <div class="w-[20px] h-[20px]">
                                                        <img src="{% static 'property-detail/line.svg' %}" alt="Line">
                                                    </div>
                                                    <div class="text-[#444F85] font-medium text-[16px]">
                                                        {{ seller_line_id }}
                                                    </div>
                                                </div>
                                            </div>
                                        </button>
                                        {% endif %}

                                        <!-- Mail Button -->
                                        {% if seller_email %}
                                        <button name="mail" onclick="flipCard(this, 'mail-info')" class="flip-card flex p-2 items-center gap-2 self-stretch rounded-md border border-[#D0D9EF] bg-[#FAF9F6] transition-transform duration-300">
                                            <div class="flip-card-inner">
                                                <div class="flip-card-front flex items-center gap-2">
                                                    <div class="w-[20px] h-[16px]">
                                                        <img src="{% static 'property-detail/mail.svg' %}" alt="Mail">
                                                    </div>
                                                    <div class="text-[#444F85] font-medium text-[16px]">
                                                        อีเมล
                                                    </div>
                                                </div>
                                                <div class="flip-card-back flex items-center gap-2 hidden" id="mail-info">
                                                    <div class="w-[20px] h-[16px]">
                                                        <img src="{% static 'property-detail/mail.svg' %}" alt="Mail">
                                                    </div>
                                                    <div class="text-[#444F85] font-medium text-[16px]">
                                                        {{ seller_email }}
                                                    </div>
                                                </div>
                                            </div>
                                        </button>
                                        {% endif %}
                                    </div>
                                    <!-- Form -->
                                    <div class="flex p-2.5 justify-center items-center gap-2.5 self-stretch rounded-lg bg-[#2162D0]">
                                        <div class="text-[#FAF9F6] text-center text-[16px] font-normal leading-normal flex-[1_0_0]">
                                            แจ้งข้อมูลเบื้องต้น เช่น ชื่อ, เบอร์โทร, ความสนใจ เมื่อเริ่มการสนทนา
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Compare Frame -->
                        <div class="flex flex-col items-start gap-[8px] self-stretch">
                            <div class="flex content-center items-center gap-[10px] self-stretch border-b border-[#575B6F]">
                                <div class="text-[#575B6F] text-[22px] font-medium leading-normal flex-[1_0_0]">
                                    เปรียบเทียบ
                                </div>
                            </div>
                            <button class="flex p-2.5 justify-center items-start gap-2 self-stretch rounded-md bg-[#2DAB6F] hover:bg-[#24975e] active:ring-2 active:ring-[#1e7c4d] transition duration-200 ease-in-out">
                                <div class="w-[25px] h-[25px]">
                                    <img src="{% static 'property-detail/compare.svg' %}" alt="Compare">
                                </div>
                                <div class="text-[#FAF9F6] text-[16px] font-bold leading-normal">
                                    เปรียบเทียบระแวกนี้
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Similar Properties -->
            <div class="flex flex-col items-center gap-[3px] self-stretch">
                <div class="text-[#2162D0] text-[32px] font-bold leading-normal self-stretch">
                    แนะนำบ้านอื่นที่คล้ายกัน
                </div>
                <!-- list -->
                <div class="flex flex-wrap justify-start gap-[24px] self-stretch">
                    <!-- for loop card -->
                    {% for related in related_properties %}
                        <div class="h-auto p-5 rounded-[10px] border border-[#d0d8ef] flex-col justify-start items-start gap-4 inline-flex">
                            <img src="{{ related.main_image }}" class="w-full h-[222px] rounded-md object-cover">
                                <div class="self-stretch h-[249px] flex-col justify-start items-start gap-4 flex">
                                    <div class="self-stretch h-[180px] flex-col justify-start items-start gap-4 flex">
                                        <div class="self-stretch justify-between items-center inline-flex">
                                            <div class="w-[371px] text-[#444f85] text-base font-bold font-['IBM Plex Sans Thai']">{{ related.title }}</div>
                                            <div data-svg-wrapper>
                                                <svg width="25" height="34" viewBox="0 0 25 34" fill="none"
                                                     xmlns="http://www.w3.org/2000/svg">
                                                    <path fill-rule="evenodd" clip-rule="evenodd"
                                                          d="M0.25 32.4684V4.62463C0.25 3.53062 0.684597 2.48141 1.45818 1.70782C2.23177 0.934231 3.28098 0.499634 4.375 0.499634L20.875 0.499634C21.969 0.499634 23.0182 0.934231 23.7918 1.70782C24.5654 2.48141 25 3.53062 25 4.62463V32.4684C25.0001 32.6475 24.9536 32.8235 24.8651 32.9791C24.7765 33.1348 24.6489 33.2647 24.4949 33.3561C24.3409 33.4474 24.1657 33.4971 23.9867 33.5002C23.8076 33.5033 23.6309 33.4598 23.4738 33.3738L12.625 27.4544L1.77625 33.3738C1.61915 33.4598 1.44237 33.5033 1.26332 33.5002C1.08426 33.4971 0.909107 33.4474 0.755089 33.3561C0.601072 33.2647 0.473502 33.1348 0.384938 32.9791C0.296374 32.8235 0.249869 32.6475 0.25 32.4684ZM13.6562 9.78088C13.6562 9.50738 13.5476 9.24508 13.3542 9.05168C13.1608 8.85828 12.8985 8.74963 12.625 8.74963C12.3515 8.74963 12.0892 8.85828 11.8958 9.05168C11.7024 9.24508 11.5938 9.50738 11.5938 9.78088V12.8746H8.5C8.2265 12.8746 7.96419 12.9833 7.7708 13.1767C7.5774 13.3701 7.46875 13.6324 7.46875 13.9059C7.46875 14.1794 7.5774 14.4417 7.7708 14.6351C7.96419 14.8285 8.2265 14.9371 8.5 14.9371H11.5938V18.0309C11.5938 18.3044 11.7024 18.5667 11.8958 18.7601C12.0892 18.9535 12.3515 19.0621 12.625 19.0621C12.8985 19.0621 13.1608 18.9535 13.3542 18.7601C13.5476 18.5667 13.6562 18.3044 13.6562 18.0309V14.9371H16.75C17.0235 14.9371 17.2858 14.8285 17.4792 14.6351C17.6726 14.4417 17.7812 14.1794 17.7812 13.9059C17.7812 13.6324 17.6726 13.3701 17.4792 13.1767C17.2858 12.9833 17.0235 12.8746 16.75 12.8746H13.6562V9.78088Z"
                                                          fill="#2162D0"/>
                                                </svg>
                                            </div>
                                        </div>
                                        <div class="px-[9px] py-2 bg-[#2162d0] rounded-md justify-center items-center gap-1.5 inline-flex">
                                            <div data-svg-wrapper class="relative">
                                                <svg width="13" height="14" viewBox="0 0 13 14" fill="none"
                                                     xmlns="http://www.w3.org/2000/svg">
                                                    <g clip-path="url(#clip0_17_741)">
                                                        <path fill-rule="evenodd" clip-rule="evenodd"
                                                              d="M2.51875 9.8C2.55659 9.74566 2.60566 9.70156 2.66207 9.67119C2.71848 9.64081 2.78068 9.625 2.84375 9.625H4.875C4.98274 9.625 5.08608 9.67109 5.16226 9.75314C5.23845 9.83519 5.28125 9.94647 5.28125 10.0625C5.28125 10.1785 5.23845 10.2898 5.16226 10.3719C5.08608 10.4539 4.98274 10.5 4.875 10.5H3.04688L1.21875 13.125H11.7812L9.95312 10.5H8.125C8.01726 10.5 7.91392 10.4539 7.83774 10.3719C7.76155 10.2898 7.71875 10.1785 7.71875 10.0625C7.71875 9.94647 7.76155 9.83519 7.83774 9.75314C7.91392 9.67109 8.01726 9.625 8.125 9.625H10.1562C10.2193 9.625 10.2815 9.64081 10.3379 9.67119C10.3943 9.70156 10.4434 9.74566 10.4812 9.8L12.9187 13.3C12.964 13.365 12.9916 13.4423 12.9984 13.5232C13.0051 13.6041 12.9909 13.6855 12.9571 13.7582C12.9234 13.8308 12.8715 13.8919 12.8073 13.9347C12.7432 13.9774 12.6692 14 12.5938 14H0.40625C0.330805 14 0.25685 13.9774 0.192672 13.9347C0.128494 13.8919 0.0766294 13.8308 0.0428891 13.7582C0.00914891 13.6855 -0.00513371 13.6041 0.00164172 13.5232C0.00841715 13.4423 0.0359829 13.365 0.0812502 13.3L2.51875 9.8Z"
                                                              fill="#FAF9F6"/>
                                                        <path fill-rule="evenodd" clip-rule="evenodd"
                                                              d="M3.25 3.50001C3.25006 2.82646 3.43058 2.16723 3.76991 1.60143C4.10924 1.03563 4.59297 0.587287 5.16303 0.310205C5.7331 0.0331227 6.3653 -0.0609304 6.98378 0.0393309C7.60225 0.139592 8.18073 0.429909 8.64979 0.875446C9.11885 1.32098 9.45857 1.90281 9.6282 2.55112C9.79782 3.19943 9.79013 3.88668 9.60607 4.5304C9.422 5.17412 9.06936 5.74697 8.59047 6.18022C8.11158 6.61346 7.52679 6.88869 6.90625 6.97289V11.8125C6.90625 11.9285 6.86345 12.0398 6.78726 12.1219C6.71108 12.2039 6.60774 12.25 6.5 12.25C6.39226 12.25 6.28893 12.2039 6.21274 12.1219C6.13655 12.0398 6.09375 11.9285 6.09375 11.8125V6.97376C5.30803 6.86716 4.5855 6.45527 4.06186 5.81547C3.53823 5.17567 3.24953 4.35286 3.25 3.50001Z"
                                                              fill="#FAF9F6"/>
                                                    </g>
                                                    <defs>
                                                        <clipPath id="clip0_17_741">
                                                            <rect width="13" height="14" fill="white"/>
                                                        </clipPath>
                                                    </defs>
                                                </svg>
                                            </div>
                                            <div class="text-[#faf9f6] text-xs font-normal font-['IBM Plex Sans Thai'] max-w-[150px] truncate overflow-hidden whitespace-nowrap">
                                                {{ related.location }}
                                            </div>
                                        </div>
                                        <div class="self-stretch justify-start items-center inline-flex">
                                            <div class="px-2.5 border-r border-[#575b6f] justify-start items-center gap-1.5 flex">
                                                <div data-svg-wrapper class="relative">
                                                    <svg width="15" height="16" viewBox="0 0 15 16" fill="none"
                                                         xmlns="http://www.w3.org/2000/svg">
                                                        <g clip-path="url(#clip0_17_747)">
                                                            <path d="M0.9375 0.5C0.68886 0.5 0.450403 0.598772 0.274587 0.774587C0.0987721 0.950403 0 1.18886 0 1.4375L0 14.5625C0 14.8111 0.0987721 15.0496 0.274587 15.2254C0.450403 15.4012 0.68886 15.5 0.9375 15.5H5.625V14.5625H1.875V13.625H5.625V12.6875H3.75V11.75H5.625V10.8125H1.875V9.875H5.625V8.9375H3.75V8H5.625V7.0625H1.875V6.125H5.625V2.375H6.5625V6.125H7.5V4.25H8.4375V6.125H9.375V2.375H10.3125V6.125H11.25V4.25H12.1875V6.125H13.125V2.375H14.0625V6.125H15V1.4375C15 1.18886 14.9012 0.950403 14.7254 0.774587C14.5496 0.598772 14.3111 0.5 14.0625 0.5H0.9375Z"
                                                                  fill="#575B6F"/>
                                                        </g>
                                                        <defs>
                                                            <clipPath id="clip0_17_747">
                                                                <rect width="15" height="15" fill="white"
                                                                      transform="translate(0 0.5)"/>
                                                            </clipPath>
                                                        </defs>
                                                    </svg>
                                                </div>
                                                <div class="text-[#575b6f] text-xs font-normal font-['IBM Plex Sans Thai']">{{ related.area }}
                                                    ตร.ว.
                                                </div>
                                            </div>
                                            <div class="px-2.5 justify-start items-center gap-1.5 flex">
                                                <div data-svg-wrapper>
                                                    <svg width="18" height="16" viewBox="0 0 18 16" fill="none"
                                                         xmlns="http://www.w3.org/2000/svg">
                                                        <path d="M18 11.3V15.5H9.6V10.1H4.2V4.7H0V0.5H8.4V5.9H13.8V11.3H18Z"
                                                              fill="#575B6F"/>
                                                    </svg>
                                                </div>
                                                <div class="text-[#575b6f] text-xs font-normal font-['IBM Plex Sans Thai']">{{ related.floors }}
                                                    ชั้น
                                                </div>
                                            </div>
                                            <div class="px-2.5 border-l border-r border-[#575b6f] justify-start items-center gap-1.5 flex">
                                                <div data-svg-wrapper>
                                                    <svg width="17" height="16" viewBox="0 0 17 16" fill="none"
                                                         xmlns="http://www.w3.org/2000/svg">
                                                        <path d="M15 8V1.33333C15 1.11232 14.9122 0.900358 14.7559 0.744078C14.5996 0.587797 14.3877 0.5 14.1667 0.5C13.9457 0.5 13.7337 0.587797 13.5774 0.744078C13.4211 0.900358 13.3333 1.11232 13.3333 1.33333V3H3.33333V1.33333C3.33333 1.11232 3.24554 0.900358 3.08926 0.744078C2.93298 0.587797 2.72101 0.5 2.5 0.5C2.27899 0.5 2.06702 0.587797 1.91074 0.744078C1.75446 0.900358 1.66667 1.11232 1.66667 1.33333V8C1.22464 8 0.800716 8.17559 0.488155 8.48816C0.175595 8.80072 0 9.22464 0 9.66667V14.6667C0 14.8877 0.0877973 15.0996 0.244078 15.2559C0.400358 15.4122 0.61232 15.5 0.833333 15.5C1.05435 15.5 1.26631 15.4122 1.42259 15.2559C1.57887 15.0996 1.66667 14.8877 1.66667 14.6667V13H15V14.6667C15 14.8877 15.0878 15.0996 15.2441 15.2559C15.4004 15.4122 15.6123 15.5 15.8333 15.5C16.0543 15.5 16.2663 15.4122 16.4226 15.2559C16.5789 15.0996 16.6667 14.8877 16.6667 14.6667V9.66667C16.6667 9.22464 16.4911 8.80072 16.1785 8.48816C15.8659 8.17559 15.442 8 15 8ZM7.5 8H3.33333V7.16667C3.33333 6.94565 3.42113 6.73369 3.57741 6.57741C3.73369 6.42113 3.94565 6.33333 4.16667 6.33333H6.66667C6.88768 6.33333 7.09964 6.42113 7.25592 6.57741C7.4122 6.73369 7.5 6.94565 7.5 7.16667V8ZM13.3333 8H9.16667V7.16667C9.16667 6.94565 9.25446 6.73369 9.41074 6.57741C9.56702 6.42113 9.77899 6.33333 10 6.33333H12.5C12.721 6.33333 12.933 6.42113 13.0893 6.57741C13.2455 6.73369 13.3333 6.94565 13.3333 7.16667V8Z"
                                                              fill="#575B6F"/>
                                                    </svg>
                                                </div>
                                                <div class="text-[#575b6f] text-xs font-normal font-['IBM Plex Sans Thai']">{{ related.bedrooms }}
                                                    ห้องนอน
                                                </div>
                                            </div>
                                            <div class="px-2.5 justify-start items-center gap-1.5 flex">
                                                <div data-svg-wrapper>
                                                    <svg width="12" height="16" viewBox="0 0 12 16" fill="none"
                                                         xmlns="http://www.w3.org/2000/svg">
                                                        <path d="M11.5416 1.625V15.125C11.5416 15.2245 11.5021 15.3198 11.4318 15.3902C11.3615 15.4605 11.2661 15.5 11.1666 15.5C11.0672 15.5 10.9718 15.4605 10.9015 15.3902C10.8311 15.3198 10.7916 15.2245 10.7916 15.125V1.625C10.7916 1.52554 10.7521 1.43016 10.6818 1.35984C10.6115 1.28951 10.5161 1.25 10.4166 1.25H4.79163C4.69217 1.25 4.59679 1.28951 4.52646 1.35984C4.45613 1.43016 4.41663 1.52554 4.41663 1.625V3.875C4.64854 3.87569 4.87455 3.94815 5.06363 4.08244C5.25271 4.21673 5.39558 4.40626 5.47263 4.625H2.61063C2.68767 4.40626 2.83054 4.21673 3.01962 4.08244C3.2087 3.94815 3.43471 3.87569 3.66663 3.875V1.625C3.66692 1.32672 3.78555 1.04075 3.99646 0.829834C4.20737 0.61892 4.49335 0.500298 4.79163 0.5H10.4166C10.7149 0.500298 11.0009 0.61892 11.2118 0.829834C11.4227 1.04075 11.5413 1.32672 11.5416 1.625ZM4.04163 9.875C3.94217 9.875 3.84679 9.91451 3.77646 9.98483C3.70613 10.0552 3.66663 10.1505 3.66663 10.25V11.75C3.66663 11.8495 3.70613 11.9448 3.77646 12.0152C3.84679 12.0855 3.94217 12.125 4.04163 12.125C4.14108 12.125 4.23647 12.0855 4.30679 12.0152C4.37712 11.9448 4.41663 11.8495 4.41663 11.75V10.25C4.41663 10.1505 4.37712 10.0552 4.30679 9.98483C4.23647 9.91451 4.14108 9.875 4.04163 9.875ZM1.79163 10.25C1.69217 10.25 1.59679 10.2895 1.52646 10.3598C1.45613 10.4302 1.41663 10.5255 1.41663 10.625V11C1.41663 11.0995 1.45613 11.1948 1.52646 11.2652C1.59679 11.3355 1.69217 11.375 1.79163 11.375C1.89108 11.375 1.98647 11.3355 2.05679 11.2652C2.12712 11.1948 2.16663 11.0995 2.16663 11V10.625C2.16663 10.5255 2.12712 10.4302 2.05679 10.3598C1.98647 10.2895 1.89108 10.25 1.79163 10.25ZM5.54163 5.375H2.54163C2.04453 5.3756 1.56796 5.57333 1.21646 5.92483C0.864956 6.27633 0.667221 6.7529 0.666626 7.25V8.75C0.666626 8.84946 0.706135 8.94484 0.776461 9.01517C0.846787 9.08549 0.94217 9.125 1.04163 9.125H7.04163C7.14108 9.125 7.23646 9.08549 7.30679 9.01517C7.37712 8.94484 7.41663 8.84946 7.41663 8.75V7.25C7.41603 6.7529 7.2183 6.27633 6.86679 5.92483C6.51529 5.57333 6.03872 5.3756 5.54163 5.375ZM1.79163 12.125C1.69217 12.125 1.59679 12.1645 1.52646 12.2348C1.45613 12.3052 1.41663 12.4005 1.41663 12.5V13.25C1.41663 13.3495 1.45613 13.4448 1.52646 13.5152C1.59679 13.5855 1.69217 13.625 1.79163 13.625C1.89108 13.625 1.98647 13.5855 2.05679 13.5152C2.12712 13.4448 2.16663 13.3495 2.16663 13.25V12.5C2.16663 12.4005 2.12712 12.3052 2.05679 12.2348C1.98647 12.1645 1.89108 12.125 1.79163 12.125ZM6.29163 9.875C6.19217 9.875 6.09679 9.91451 6.02646 9.98483C5.95613 10.0552 5.91663 10.1505 5.91663 10.25V11C5.91663 11.0995 5.95613 11.1948 6.02646 11.2652C6.09679 11.3355 6.19217 11.375 6.29163 11.375C6.39108 11.375 6.48646 11.3355 6.55679 11.2652C6.62712 11.1948 6.66663 11.0995 6.66663 11V10.25C6.66663 10.1505 6.62712 10.0552 6.55679 9.98483C6.48646 9.91451 6.39108 9.875 6.29163 9.875ZM6.29163 12.125C6.19217 12.125 6.09679 12.1645 6.02646 12.2348C5.95613 12.3052 5.91663 12.4005 5.91663 12.5V13.25C5.91663 13.3495 5.95613 13.4448 6.02646 13.5152C6.09679 13.5855 6.19217 13.625 6.29163 13.625C6.39108 13.625 6.48646 13.5855 6.55679 13.5152C6.62712 13.4448 6.66663 13.3495 6.66663 13.25V12.5C6.66663 12.4005 6.62712 12.3052 6.55679 12.2348C6.48646 12.1645 6.39108 12.125 6.29163 12.125ZM4.04163 12.875C3.94217 12.875 3.84679 12.9145 3.77646 12.9848C3.70613 13.0552 3.66663 13.1505 3.66663 13.25V14C3.66663 14.0995 3.70613 14.1948 3.77646 14.2652C3.84679 14.3355 3.94217 14.375 4.04163 14.375C4.14108 14.375 4.23647 14.3355 4.30679 14.2652C4.37712 14.1948 4.41663 14.0995 4.41663 14V13.25C4.41663 13.1505 4.37712 13.0552 4.30679 12.9848C4.23647 12.9145 4.14108 12.875 4.04163 12.875Z"
                                                              fill="#575B6F"/>
                                                    </svg>
                                                </div>
                                                <div class="text-[#575b6f] text-xs font-normal font-['IBM Plex Sans Thai']">{{ related.bathrooms }}
                                                    ห้องน้ำ
                                                </div>
                                            </div>
                                        </div>
                                        <div class="justify-start items-center gap-2 inline-flex">
                                            <div class="px-2 py-0.5 bg-[#faf9f6] rounded-md border border-[#d0d8ef] justify-center items-center gap-1.5 flex">
                                                <div class="text-[#575b6f] text-xs font-normal font-['IBM Plex Sans Thai']">
                                                    เลี้ยงสัตว์ได้
                                                </div>
                                            </div>
                                            <div class="px-2 py-0.5 bg-[#faf9f6] rounded-md border border-[#d0d8ef] justify-center items-center gap-1.5 flex">
                                                <div class="text-[#575b6f] text-xs font-normal font-['IBM Plex Sans Thai']">
                                                    ใกล้อีสวิวล์
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="self-stretch justify-start items-center gap-2 inline-flex">
                                        <div class="grow shrink basis-0 text-[#2DAB6F] text-[32px] font-bold font-['IBM Plex Sans Thai']">
                                            {{ related.price|intcomma }}</div>
                                        <div class="text-[#2DAB6F] text-[32px] font-bold font-['IBM Plex Sans Thai']">
                                            บาท{% if related.transaction_type == "rent" %}/ด.{% endif %}
                                        </div>
                                    </div>
                                </div>
                                </svg>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>


    <script>
        document.querySelectorAll(".tab-info-btn").forEach(button => {
            button.addEventListener("click", function () {
                // Remove active styles from all buttons
                document.querySelectorAll(".tab-info-btn").forEach(btn => {
                    btn.classList.remove("border-b-2", "border-[#2162d0]");
                });

                // Add active style to clicked button
                this.classList.add("border-b-2", "border-[#2162d0]");

                // Get the selected tab
                let selectedTab = this.getAttribute("data-tab");

                // Hide all tab contents
                document.querySelectorAll(".tab-content").forEach(content => {
                    content.classList.add("hidden");
                });

                // Show the selected tab content
                document.querySelector(`[data-tab-content="${selectedTab}"]`).classList.remove("hidden");
            });
        });

    document.querySelectorAll(".tab-nearby-btn").forEach(button => {
        button.addEventListener("click", function () {
            document.querySelectorAll(".tab-nearby-btn").forEach(btn => {
                btn.classList.remove("border-b-2", "border-[#575B6F]");
            });
            this.classList.add("border-b-2", "border-[#575B6F]");

            let selectedCategory = this.getAttribute("data-category");
            document.querySelectorAll("#nearby-places tr").forEach(row => {
                if (selectedCategory === "all" || row.getAttribute("data-category") === selectedCategory) {
                    row.style.display = "table-row";
                } else {
                    row.style.display = "none";
                }
            });
        });
    });

    function flipCard(button, infoId) {
        const info = document.getElementById(infoId);
        const front = button.querySelector('.flip-card-front');

        if (info.classList.contains('hidden')) {
            // Flip to show info
            front.classList.add('hidden');
            info.classList.remove('hidden');
        } else {
            // Flip to show front
            front.classList.remove('hidden');
            info.classList.add('hidden');
        }
    }

    function toggleBookmark(button) {
        const icon = button.querySelector('#bookmark-icon');
        const ring = button.querySelector('span');
        const isBooked = icon.src.includes('booked.svg');

        // Toggle the image source
        icon.src = isBooked ? "{% static 'property-detail/bookmark.svg' %}" : "{% static 'property-detail/booked.svg' %}";

        // Add animation
        ring.classList.add('ring-animate');
        setTimeout(() => {
            ring.classList.remove('ring-animate');
        }, 300);
    }


    </script>

    <style>

    @keyframes ring-pop {
        0% { transform: scale(0.5); opacity: 0.5; }
        50% { transform: scale(1.1); opacity: 0.8; }
        100% { transform: scale(1); opacity: 0; }
    }

    .ring-animate {
        animation: ring-pop 0.3s ease-out;
    }

    </style>

{% endblock %}
